set title ""

mat fuel1 -10.424 
92235.09c -0.015867
92238.09c -0.86563
8016.09c -0.1185

mat coolant -0.44376 moder lwtr 1001
8016.06c 0.33333
1001.06c 0.66667


set acelib "jeff311/sss_jeff311u.xsdata" 
therm lwtr lwj3.11t

set bc 2

set pop 10000 1500 500

ene 2groups_grid 1 0.00000000E+00 6.25000000E-07 2.00000000E+01 



surf 1 cyl 0.00000000 0.00000000 0.21675000  % surf inner fuel = s1
surf 2 cyl 0.00000000 0.00000000 0.43350000  % surf outer fuel = s2
surf 3 sqc 0.00000000 0.00000000 0.64750000


cell 1 pin_fuel1 fuel1    -1        % reg1
cell 2 pin_fuel1 fuel1     1  -2    % reg2
cell 3 pin_fuel1 coolant   2  -3    % reg3

cell 4 0 fill pin_fuel1   -3 
cell 5 0 outside           3 



% ----- Surface for detectors
surf 5 px  -0.64750000
surf 6 py   0.64750000
surf 7 px   0.64750000
surf 8 py  -0.64750000


% ----- Detectors ------



det total_rate_reg2  de 2groups_grid dr -1 fuel1 dc 2  

% ------------------------------------------------------------
% FIRST TRY **************************************************
% det j_in_s2          ds 2 -1  de  2groups_grid  dfl 1 1  
% det j_in_s1          ds 1 -1  de  2groups_grid  dfl 2 1  
% det j_in_s1_not_s2   ds 1 -1  de  2groups_grid  dfl 1 3   dfl 4 1  % Neutrons that didn't cross S2 but are crossing S1
% 
% det j_out_s1    ds 1  1  de  2groups_grid  dfl 2 3  dfl 3 1   % neutrons that didn't enter inner fuel but leave the inner fuel
% det j_out_s1_p  ds 1  1  de  2groups_grid  dfl 2 3  dfl 3 1   
% 
% det j_out_s2    ds 2  1  de  2groups_grid  dfl 4 2 
% det j_out_s2_p  ds 2  1  de  2groups_grid  dfl 3 3  dfl 6 1 
% --------------------------------------------------------------
% *************************************************************


% 
% SECOND TRY **************************************************
% Neutrons that enter the fuel region and have an interaction
% 
%   - flag 1: A neutron crosses (j_in) the surface S2 (outer) 
%   - flag 2: A neutron that has crossed both surfaces without interacting
%   - flag 3: A neutron that has crossed (j_out) the S1 but it hasnt crossed S2 (j_in)
%   - flag 4: A neutron that has crossed (j_in) S1 but hasn't crossed (j_in) S2
%   - flag 5: A neutron that has crossed the F1 region without interacting and not having crossed S2 before
%   - flag 6: A neutron that has crossed S2 (outer) and will count to calculate F1 to any

det j_in_s2          ds 2 -1  de  2groups_grid  dfl 1 1                       % Neutrons that cross (j_in) S2                                  FLAG #1
det j_in_s1          ds 1 -1  de  2groups_grid  dfl 1 2  dfl 2 1              % Neutrons that cross (j_in) S1 and also crossed (j_in) S2       FLAG #2
det j_out_s1         ds 1  1  de  2groups_grid  dfl 2 0                       % Neutrons that cross (j_out) S1 and also crossed (j_in) S2     
det j_in_s1_no_s2    ds 1 -1  de  2groups_grid  dfl 1 3  dfl 4 1              % Neutrons that cross (j_in) S1 and did not crossed (j_in) S2    FLAG #4

det j_out_s1_inter   ds 1  1  de  2groups_grid  dfl 1 3  dfl 3 1              % Neutrons that cross (j_out) S1 if they didn't cross (j_in) S2  FLAG #3

det all_to_reg1  de 2groups_grid dr -1 fuel1 dc 1 dfl 1 0 dfl 2 0 dfl 4 0     % Only to reset flagswhen there is a reaction in F1
det all_to_reg2  de 2groups_grid dr -1 fuel1 dc 2 dfl 1 2 dfl 1 0             % Neutrons that crossed (j_in) S2  and then interact in F2




det reg1_to_reg2   de 2groups_grid dr -1 fuel1 dc 2   dfl 3 2  dfl 3 0        % Neutrons that have Flag #3 and then interact in F2

% neutrons from r2 to all
det reg2_to_reg1   de 2groups_grid dr -1 fuel1 dc 1   dfl 4 2  dfl 4 0        % Neutrons emmited from F2 to interact in F1
det j_out_s1_fl4   de 2groups_grid ds  1 1            dfl 4 2  dfl 5 1        % Neutrons emmited from F2 to enter F2 crossing entirely F1      FLAG #5
det tot_reset_fl5  de 2groups_grid dr -1 fuel1 dc 2   dfl 5 0  dfl 1 0        % Just to reset flag 5 in case it crosses F1 totally and 
                                                                              % interacts in F2

det j_out_s2_to_any_fl5 ds 2 1  de 2groups_grid dfl 5 2  dfl 6 1              % Neutrons emmited from F2 crossing F1 and exiting F2            FLAG #6
                                                                              % through S2 
det j_out_s2_to_any_fl1 ds 2 1  de 2groups_grid dfl 1 2  dfl 6 1              % Neutrons emmited from F2 and don't interact in F2 and          FLAG #6
                                                                              % exiting F2 through S2

% --------------------------------------------------------------



det reg2_to_reg3     dr -1 coolant dc 3 de 2groups_grid  dfl 6 2  dfl 6 0  % outer to coolant
det reg2_to_surface5 ds  5 -1           de 2groups_grid  dfl 6 2  dfl 6 0 
det reg2_to_surface6 ds  6  1           de 2groups_grid  dfl 6 2  dfl 6 0 
det reg2_to_surface7 ds  7  1           de 2groups_grid  dfl 6 2  dfl 6 0 
det reg2_to_surface8 ds  8 -1           de 2groups_grid  dfl 6 2  dfl 6 0 








